

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head><!-- hexo injector head_begin start --><link href="https://fastly.jsdelivr.net/npm/hexo-tag-common@0.2.0/css/index.css" rel="stylesheet"/><!-- hexo injector head_begin end -->
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/%E6%9C%88%E4%BA%AE.png">
  <link rel="icon" href="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/%E6%9C%88%E4%BA%AE.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Sunfove">
  <meta name="keywords" content="">
  
    <meta name="description" content="本文从几何光学的基本原理出发，详尽推导了焦深（Depth of Focus）与景深（Depth of Field）的物理公式，探讨了二者的对偶关系，分析了其在摄影、显微成像及半导体光刻中的关键应用，并附带Python计算模型。">
<meta property="og:type" content="article">
<meta property="og:title" content="透视光影的边界：从第一性原理深度解析焦深与景深">
<meta property="og:url" content="https://sunfove.xyz/2026/01/28/2026-01-28-depth-of-field-vs-depth-of-focus-analysis/index.html">
<meta property="og:site_name" content="明明如月">
<meta property="og:description" content="本文从几何光学的基本原理出发，详尽推导了焦深（Depth of Focus）与景深（Depth of Field）的物理公式，探讨了二者的对偶关系，分析了其在摄影、显微成像及半导体光刻中的关键应用，并附带Python计算模型。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_114936.png">
<meta property="og:image" content="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_111810.png">
<meta property="og:image" content="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_112134.png">
<meta property="og:image" content="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_112042.png">
<meta property="article:published_time" content="2026-01-28T05:46:21.000Z">
<meta property="article:modified_time" content="2026-01-31T15:32:02.675Z">
<meta property="article:author" content="Sunfove">
<meta property="article:tag" content="Algorithm">
<meta property="article:tag" content="Engineering">
<meta property="article:tag" content="Optics">
<meta property="article:tag" content="Photography">
<meta property="article:tag" content="Physics">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_114936.png">
  
  
  
  <title>透视光影的边界：从第一性原理深度解析焦深与景深 - 明明如月</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sunfove.xyz","root":"/","version":"1.9.8","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"a41f823c63196c4c6518678dffb957a1","google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?a41f823c63196c4c6518678dffb957a1";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>明明如月</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">透视光影的边界：从第一性原理深度解析焦深与景深</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-01-28 05:46" pubdate>
          January 28, 2026 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.9k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          41 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">透视光影的边界：从第一性原理深度解析焦深与景深</h1>
            
            
              <div class="markdown-body">
                
                <p>在光学成像的世界里，“清晰”从来不是一个绝对的二元概念，而是一个关于“容忍度”的连续函数。当我们凝视一张照片或通过显微镜观察细胞时，我们所感知的清晰范围，实际上是光学系统对误差的某种妥协。</p>
<p>这种妥协在物方空间（Object Space）表现为<strong>景深（Depth of Field, DOF）</strong>，而在像方空间（Image Space）则表现为<strong>焦深（Depth of Focus, DoFocus）</strong>。尽管这两个术语在日常摄影中常被混淆，但在光学工程、机器视觉以及半导体光刻领域，严格区分二者是理解成像系统极限的关键。</p>
<p>本文将摒弃经验法则，回归几何光学，通过数学推导揭示这两个概念的本质联系。</p>
<p><img src="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_114936.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="1-定义：清晰度的物理边界"><a href="#1-定义：清晰度的物理边界" class="headerlink" title="1. 定义：清晰度的物理边界"></a>1. 定义：清晰度的物理边界</h2><p>要讨论焦深和景深，首先必须引入一个核心概念：<strong>允许弥散圆（Circle of Confusion, CoC）</strong>。</p>
<p>在理想的高斯光学（Gaussian Optics）中，一个点光源应当汇聚成一个几何点。然而，受限于光的衍射极限（Diffraction Limit）和像差，以及成像介质（胶片颗粒或CCD&#x2F;CMOS像素）的分辨率限制，真正的“点”是不存在的。</p>
<p>当一个光斑的直径小于人眼或传感器的分辨极限时，我们主观上认为它是“清晰”的。这个临界直径，就是<strong>允许弥散圆直径</strong>，通常记为 $c$。</p>
<h3 id="1-1-焦深-Depth-of-Focus"><a href="#1-1-焦深-Depth-of-Focus" class="headerlink" title="1.1 焦深 (Depth of Focus)"></a>1.1 焦深 (Depth of Focus)</h3><p>焦深是指在保持物距不变的情况下，像平面（如胶片或传感器）沿光轴前后移动，而像点模糊程度仍保持在允许弥散圆内的移动范围。</p>
<ul>
<li><strong>物理本质</strong>：像方空间的轴向容差。</li>
<li><strong>关键场景</strong>：相机装配精度、显微镜调焦、光刻机硅片平整度要求。</li>
</ul>
<h3 id="1-2-景深-Depth-of-Field"><a href="#1-2-景深-Depth-of-Field" class="headerlink" title="1.2 景深 (Depth of Field)"></a>1.2 景深 (Depth of Field)</h3><p>景深是指在像平面（焦平面）位置固定的前提下，被摄物体在沿光轴方向前后移动时，其在像平面上成的像仍能保持清晰的距离范围。</p>
<ul>
<li><strong>物理本质</strong>：物方空间的轴向容差。</li>
<li><strong>关键场景</strong>：人像摄影（虚化背景）、风景摄影（超焦距）、机器视觉检测。</li>
</ul>
<hr>
<h2 id="2-焦深和景深的推导"><a href="#2-焦深和景深的推导" class="headerlink" title="2. 焦深和景深的推导"></a>2. 焦深和景深的推导</h2><h3 id="2-1-基础定义与符号系统"><a href="#2-1-基础定义与符号系统" class="headerlink" title="2.1 基础定义与符号系统"></a>2.1 基础定义与符号系统</h3><p>在开始推导前，必须建立严格的符号系统（遵循高斯光学符号惯例）：</p>
<ul>
<li>$f$：镜头焦距。</li>
<li>$D$：入瞳直径（光圈孔径）。</li>
<li>$N$：光圈数（F-Number），定义为 $N &#x3D; f&#x2F;D$。</li>
<li>$c$：允许弥散圆直径（Circle of Confusion, CoC）。</li>
<li>$u$：对焦平面的物距（Object Distance）。</li>
<li>$v$：对焦平面的像距（Image Distance）。</li>
<li>$m$：横向放大率（Magnification），$m &#x3D; v&#x2F;u$。</li>
</ul>
<p><img src="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_111810.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="2-2-焦深-Depth-of-Focus-的严格推导"><a href="#2-2-焦深-Depth-of-Focus-的严格推导" class="headerlink" title="2.2 焦深 (Depth of Focus) 的严格推导"></a>2.2 焦深 (Depth of Focus) 的严格推导</h3><p>焦深描述的是<strong>像方空间</strong>的容差。假设像平面从理想焦平面移动了距离 $\delta$，使得原本汇聚成一点的光锥在像平面上形成了一个直径为 $c$ 的光斑。</p>
<h4 id="2-2-1-几何构建"><a href="#2-2-1-几何构建" class="headerlink" title="2.2.1 几何构建"></a>2.2.1 几何构建</h4><p>光线从透镜后方射出，形成一个底面直径为 $D$（出瞳直径，在此简化为等于入瞳直径），高为 $v$ 的圆锥体。</p>
<p>当像平面移动 $\delta$ 距离时，根据相似三角形原理（Thales Theorem）：</p>
<p>$$<br>\frac{c}{\delta} &#x3D; \frac{D}{v}<br>$$</p>
<h4 id="2-2-2-严格推导-Exact-Derivation"><a href="#2-2-2-严格推导-Exact-Derivation" class="headerlink" title="2.2.2 严格推导 (Exact Derivation)"></a>2.2.2 严格推导 (Exact Derivation)</h4><p>从上述几何关系，我们可以直接解出单侧焦深 $\delta$：</p>
<p>$$<br>\delta &#x3D; \frac{c \cdot v}{D}<br>$$</p>
<p>利用光圈数定义 $D &#x3D; f&#x2F;N$，代入上式：</p>
<p>$$<br>\delta &#x3D; \frac{c \cdot v \cdot N}{f}<br>$$</p>
<p>引入放大率公式 $m &#x3D; v&#x2F;u$，结合高斯成像公式 $1&#x2F;u + 1&#x2F;v &#x3D; 1&#x2F;f$，我们可以推导出 $v &#x3D; f(1+m)$。将其代入 $\delta$ 的表达式：</p>
<p>$$<br>\delta &#x3D; \frac{c \cdot f(1+m) \cdot N}{f} &#x3D; N \cdot c \cdot (1 + m)<br>$$</p>
<p>因此，<strong>严格的总焦深 $t$</strong>（包含前后两侧）为：</p>
<p>$$<br>t_{\text{exact}} &#x3D; 2 \cdot \delta &#x3D; 2 \cdot N \cdot c \cdot (1 + m)<br>$$</p>
<blockquote>
<p><strong>物理意义</strong>：此公式表明，焦深不仅取决于光圈 $N$ 和弥散圆 $c$，还与放大率 $m$ 线性相关。在微距摄影（$m$ 较大）中，焦深会显著增加。</p>
</blockquote>
<h4 id="2-2-3-近似推导-Approximation"><a href="#2-2-3-近似推导-Approximation" class="headerlink" title="2.2.3 近似推导 (Approximation)"></a>2.2.3 近似推导 (Approximation)</h4><p>在普通摄影场景中，物距通常远大于焦距（$u \gg f$），此时放大率 $m &#x3D; v&#x2F;u \approx 0$。像距 $v$ 无限接近于焦距 $f$。</p>
<p>忽略 $m$ 项，我们得到工程上最常用的近似公式：</p>
<p>$$<br>t_{\text{approx}} &#x3D; 2 \cdot N \cdot c<br>$$</p>
<hr>
<h3 id="2-3-景深-Depth-of-Field-的严格推导"><a href="#2-3-景深-Depth-of-Field-的严格推导" class="headerlink" title="2.3 景深 (Depth of Field) 的严格推导"></a>2.3 景深 (Depth of Field) 的严格推导</h3><p>景深的推导涉及物象共轭关系的非线性变换，比焦深复杂得多。</p>
<h4 id="2-3-1-几何构建与前置条件"><a href="#2-3-1-几何构建与前置条件" class="headerlink" title="2.3.1 几何构建与前置条件"></a>2.3.1 几何构建与前置条件</h4><p>设对焦在距离 $u$ 处，此时像距为 $v$。</p>
<ul>
<li><strong>近景深界限 $u_n$</strong>：物体移近到 $u_n$，其像点退后到 $v + \delta$，在原像平面 $v$ 处形成直径为 $c$ 的弥散圆。</li>
<li><strong>远景深界限 $u_f$</strong>：物体移远到 $u_f$，其像点前移到 $v - \delta$，在原像平面 $v$ 处形成直径为 $c$ 的弥散圆。</li>
</ul>
<p>根据像方几何关系（参考焦深推导），允许的像距偏移量 $\delta$ 为：<br>$$<br>\delta &#x3D; \frac{c \cdot v}{D}<br>$$</p>
<h4 id="2-3-2-严格推导-Exact-Derivation"><a href="#2-3-2-严格推导-Exact-Derivation" class="headerlink" title="2.3.2 严格推导 (Exact Derivation)"></a>2.3.2 严格推导 (Exact Derivation)</h4><p>我们需要求解满足像距为 $v’ &#x3D; v + \delta$ 的物距 $u_n$。根据高斯公式：</p>
<p>$$<br>u_n &#x3D; \frac{f \cdot v’}{v’ - f} &#x3D; \frac{f(v + \delta)}{v + \delta - f}<br>$$</p>
<p>将 $\delta &#x3D; cv&#x2F;D$ 代入：</p>
<p>$$<br>u_n &#x3D; \frac{f(v + \frac{cv}{D})}{v + \frac{cv}{D} - f}<br>$$</p>
<p>这是一个极其繁琐的代数式。为了简化，我们引入<strong>超焦距 $H$</strong> 的严格定义。<br>当对焦在无穷远时，$v&#x3D;f$，此时像平面上的模糊斑直径由 $D$ 和 $f$ 决定。令无穷远物体的像斑刚好为 $c$，对应的最近清晰距离为 $H$。</p>
<p>严格的超焦距公式为：<br>$$<br>H &#x3D; \frac{f^2}{N \cdot c} + f<br>$$<br><em>(注：绝大多数教材忽略末尾的 $+f$，但在严格推导中我们将保留它或在最后一步省略)</em></p>
<p>经过繁琐的代数变换（利用 $1&#x2F;u + 1&#x2F;v &#x3D; 1&#x2F;f$ 消除 $v$），我们可以得到<strong>严格的景深界限公式</strong>：</p>
<p>$$<br>u_n &#x3D; \frac{u \cdot H_{\text{approx}}}{H_{\text{approx}} + (u - f)}<br>$$<br>$$<br>u_f &#x3D; \frac{u \cdot H_{\text{approx}}}{H_{\text{approx}} - (u - f)}<br>$$</p>
<p>其中 $H_{\text{approx}} &#x3D; f^2 &#x2F; (Nc)$。</p>
<p><strong>严格的总景深 $\Delta L$</strong>：</p>
<p>$$<br>\Delta L_{\text{exact}} &#x3D; u_f - u_n &#x3D; \frac{2 u (u-f) H_{\text{approx}}}{H_{\text{approx}}^2 - (u-f)^2}<br>$$</p>
<p>将 $H_{\text{approx}}$ 展开，得到完全展开式：</p>
<p>$$<br>\Delta L_{\text{exact}} &#x3D; \frac{2 \cdot u \cdot (u-f) \cdot f^2 \cdot N \cdot c}{f^4 - (u-f)^2 \cdot N^2 \cdot c^2}<br>$$</p>
<h4 id="2-3-3-近似推导-Approximation"><a href="#2-3-3-近似推导-Approximation" class="headerlink" title="2.3.3 近似推导 (Approximation)"></a>2.3.3 近似推导 (Approximation)</h4><p>上述公式在工程应用中过于复杂。我们进行三级近似：</p>
<p><strong>近似条件 1</strong>：$u \gg f$（非微距摄影）。<br>此时 $(u-f) \approx u$。</p>
<p><strong>近似条件 2</strong>：$H \gg u$（对焦距离远小于超焦距）。<br>这意味着分母中 $H^2$ 远大于 $(u-f)^2$，可以忽略减数项。</p>
<p>基于这两个条件，公式简化为：</p>
<p>$$<br>\Delta L \approx \frac{2 u \cdot u \cdot H}{H^2} &#x3D; \frac{2 u^2}{H}<br>$$</p>
<p>代入 $H \approx f^2 &#x2F; (Nc)$：</p>
<p>$$<br>\Delta L_{\text{approx}} &#x3D; \frac{2 u^2 N c}{f^2}<br>$$</p>
<p>这就是我们在摄影教材中见到的经典公式。</p>
<hr>
<h3 id="2-4-总结与对比表"><a href="#2-4-总结与对比表" class="headerlink" title="2.4 总结与对比表"></a>2.4 总结与对比表</h3><p>为了清晰展示严格解与近似解的区别，我们将其总结如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">严格公式 (Exact Formula)</th>
<th align="left">近似公式 (Approximation)</th>
<th align="left">适用条件</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>焦深 (DoFocus)</strong></td>
<td align="left">$$t &#x3D; 2Nc(1+m)$$</td>
<td align="left">$$t &#x3D; 2Nc$$</td>
<td align="left">普通摄影 ($m \approx 0$)</td>
</tr>
<tr>
<td align="left"><strong>超焦距 ($H$)</strong></td>
<td align="left">$$H &#x3D; \frac{f^2}{Nc} + f$$</td>
<td align="left">$$H &#x3D; \frac{f^2}{Nc}$$</td>
<td align="left">长焦或大光圈 ($f^2&#x2F;Nc \gg f$)</td>
</tr>
<tr>
<td align="left"><strong>近景深 ($u_n$)</strong></td>
<td align="left">$$\frac{u H}{H + (u-f)}$$</td>
<td align="left">$$\frac{u H}{H + u}$$</td>
<td align="left">物距远大于焦距 ($u \gg f$)</td>
</tr>
<tr>
<td align="left"><strong>远景深 ($u_f$)</strong></td>
<td align="left">$$\frac{u H}{H - (u-f)}$$</td>
<td align="left">$$\frac{u H}{H - u}$$</td>
<td align="left">物距远大于焦距 ($u \gg f$)</td>
</tr>
<tr>
<td align="left"><strong>总景深 (DoF)</strong></td>
<td align="left">$$\frac{2 u (u-f) H}{H^2 - (u-f)^2}$$</td>
<td align="left">$$\frac{2 u^2 N c}{f^2}$$</td>
<td align="left">$u \gg f$ 且 $u \ll H$</td>
</tr>
</tbody></table>
<h3 id="2-5-什么时候必须使用严格公式？"><a href="#2-5-什么时候必须使用严格公式？" class="headerlink" title="2.5 什么时候必须使用严格公式？"></a>2.5 什么时候必须使用严格公式？</h3><ol>
<li><strong>微距摄影 (Macro Photography)</strong>：当放大率 $m &gt; 0.1$ 时，近似公式误差呈指数级上升。此时焦深必须考虑 $(1+m)$ 项，否则会导致对焦行程估算严重不足。</li>
<li><strong>显微镜设计</strong>：在显微光学中，$m \gg 1$，此时近似公式完全失效。</li>
<li><strong>大画幅相机</strong>：由于焦距 $f$ 较长，且经常使用小光圈，严格计算超焦距中的 $+f$ 项有时也是必要的修正。</li>
</ol>
<h3 id="2-6焦深与景深影响因素"><a href="#2-6焦深与景深影响因素" class="headerlink" title="2.6焦深与景深影响因素"></a>2.6焦深与景深影响因素</h3><p>在光学工程与摄影实践中，区分“物方空间”与“像方空间”的容差至关重要。下表总结了核心参数变化时，景深与焦深的响应差异。</p>
<table>
<thead>
<tr>
<th align="left">影响因素 (Factor)</th>
<th align="left">变化方向 (Change)</th>
<th align="left">对景深 (DOF) 的影响<br><em>(物方空间)</em></th>
<th align="left">对焦深 (DoFocus) 的影响<br><em>(像方空间)</em></th>
<th align="left">物理原理 &#x2F; 公式依赖</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>光圈系数 ($N$)</strong><br><em>(F-Number)</em></td>
<td align="left"><strong>变大</strong> ($F2.8 \to F11$)<br><em>(光圈孔径变小)</em></td>
<td align="left"><strong>变深 (Deep)</strong><br>范围显著扩大</td>
<td align="left"><strong>变深 (Deep)</strong><br>焦平面容差变大</td>
<td align="left">两者均与 $N$ 成正比。<br>光束锥角变小，弥散斑扩散变慢。</td>
</tr>
<tr>
<td align="left"><strong>镜头焦距 ($f$)</strong><br><em>(Focal Length)</em></td>
<td align="left"><strong>变长</strong> ($24mm \to 200mm$)<br><em>(长焦镜头)</em></td>
<td align="left"><strong>变浅 (Shallow)</strong><br>背景虚化强烈</td>
<td align="left"><strong>基本不变</strong><br><em>(普通摄影距离下)</em></td>
<td align="left">DOF $\propto 1&#x2F;f^2$ (平方反比)。<br>焦深主要取决于光圈和 $c$，与焦距无直接关系。</td>
</tr>
<tr>
<td align="left"><strong>拍摄距离 ($u$)</strong><br><em>(Subject Distance)</em></td>
<td align="left"><strong>变远</strong> ($0.5m \to 50m$)<br><em>(远离物体)</em></td>
<td align="left"><strong>变深 (Deep)</strong><br>且增长极快</td>
<td align="left"><strong>基本不变</strong><br><em>(除非进入微距领域)</em></td>
<td align="left">DOF $\propto u^2$ (平方正比)。<br>焦深主要受放大率 $m$ 影响，远距离时 $m \to 0$，焦深恒定。</td>
</tr>
<tr>
<td align="left"><strong>允许弥散圆 ($c$)</strong><br><em>(CoC &#x2F; Pixel Size)</em></td>
<td align="left"><strong>变大</strong><br><em>(低像素或小画幅)</em></td>
<td align="left"><strong>变深 (Deep)</strong><br>看起来更清晰</td>
<td align="left"><strong>变深 (Deep)</strong><br>装配精度要求降低</td>
<td align="left">两者均与 $c$ 成线性正比。<br>判定“清晰”的标准越宽松，深度越大。</td>
</tr>
<tr>
<td align="left"><strong>放大率 ($m$)</strong><br><em>(Magnification)</em></td>
<td align="left"><strong>变大</strong><br><em>(微距摄影)</em></td>
<td align="left"><strong>极浅 (Very Shallow)</strong><br>毫米级景深</td>
<td align="left"><strong>变深 (Deep)</strong><br>显著增加</td>
<td align="left">互为倒数关系 (近似)。<br>焦深 $\approx m^2 \times$ 景深。</td>
</tr>
</tbody></table>
<h2 id="3-焦深与景深的关系：纵向放大率"><a href="#3-焦深与景深的关系：纵向放大率" class="headerlink" title="3. 焦深与景深的关系：纵向放大率"></a>3. 焦深与景深的关系：纵向放大率</h2><p>物理学的美妙之处在于对称性。焦深和景深实际上是共轭关系，通过<strong>纵向放大率（Longitudinal Magnification）</strong> 联系在一起。</p>
<p>如果你熟悉微分，我们可以对高斯公式 $\frac{1}{u} + \frac{1}{v} &#x3D; \frac{1}{f}$ 进行微分：</p>
<p>$$<br>-\frac{du}{u^2} - \frac{dv}{v^2} &#x3D; 0 \implies dv &#x3D; - \left( \frac{v}{u} \right)^2 du<br>$$</p>
<p>其中：</p>
<ul>
<li>$dv$ 对应焦深（像平面位置变化）。</li>
<li>$du$ 对应景深（物平面位置变化）。</li>
<li>$m &#x3D; v&#x2F;u$ 是横向放大率（Lateral Magnification）。</li>
</ul>
<p>因此，我们得到一个极其优雅的近似关系：</p>
<p>$$<br>\text{焦深} \approx m^2 \times \text{景深}<br>$$</p>
<p>或者：</p>
<p>$$<br>\text{景深} \approx \frac{\text{焦深}}{m^2}<br>$$</p>
<h3 id="深度解析"><a href="#深度解析" class="headerlink" title="深度解析"></a>深度解析</h3><ul>
<li><strong>普通摄影 ($m \ll 1$)</strong>：物体很大，像很小。$m^2$ 极小。因此，<strong>景深很大，焦深很小</strong>。这意味着拍摄时我们可以容忍物体前后移动一点，但胶片&#x2F;传感器必须非常精确地放置在焦平面上。</li>
<li><strong>显微摄影 ($m \gg 1$)</strong>：物体很小，像很大。$m^2$ 极大。因此，<strong>景深极小，焦深很大</strong>。这意味着显微镜调节旋钮需要极其微小的移动才能对上焦，但像平面（目镜或相机）的位置反而没那么敏感。</li>
</ul>
<hr>
<h2 id="4-实际生活中景深和焦深影响的案例"><a href="#4-实际生活中景深和焦深影响的案例" class="headerlink" title="4. 实际生活中景深和焦深影响的案例"></a>4. 实际生活中景深和焦深影响的案例</h2><h3 id="4-1-景深案例：电影感与叙事"><a href="#4-1-景深案例：电影感与叙事" class="headerlink" title="4.1 景深案例：电影感与叙事"></a>4.1 景深案例：电影感与叙事</h3><p>在电影《肖申克的救赎》中，导演经常使用浅景深将主角从背景杂乱的监狱环境中剥离出来，这种**视觉隔离（Visual Isolation）**引导观众只关注角色的表情。</p>
<ul>
<li><strong>技术实现</strong>：使用85mm或更大焦距的镜头，配合T1.4的大光圈。</li>
<li><strong>对立面</strong>：新闻纪实摄影通常使用F8或F11的小光圈（超焦距技术），确保前景的突发事件和背景的环境信息都清晰，以交代完整的“故事上下文”。</li>
</ul>
<h3 id="4-2-焦深案例：光刻机-Lithography"><a href="#4-2-焦深案例：光刻机-Lithography" class="headerlink" title="4.2 焦深案例：光刻机 (Lithography)"></a>4.2 焦深案例：光刻机 (Lithography)</h3><p>这是焦深概念最昂贵的应用场景。在制造7nm或3nm芯片时，光刻机需要将纳米级的电路图案投影到硅片上。</p>
<ul>
<li><strong>挑战</strong>：极高的数值孔径（NA）导致焦深（DoFocus）极浅，往往只有几十纳米。</li>
<li><strong>后果</strong>：如果硅片表面有微小的起伏，或者平整度不够，电路图就会模糊，导致芯片报废。</li>
<li><strong>解决方案</strong>：CMP（化学机械抛光）工艺必须将晶圆表面打磨到原子级的平整，以适应极浅的焦深。</li>
</ul>
<h3 id="4-3-工业视觉：远心镜头-Telecentric-Lens"><a href="#4-3-工业视觉：远心镜头-Telecentric-Lens" class="headerlink" title="4.3 工业视觉：远心镜头 (Telecentric Lens)"></a>4.3 工业视觉：远心镜头 (Telecentric Lens)</h3><p>在精密工业测量中，普通镜头的景深会带来透视误差（近大远小）。</p>
<ul>
<li><strong>应用</strong>：使用双远心镜头，不仅消除了透视误差，还通过特殊的光阑设计，在一定景深范围内保持放大倍率恒定，确保机器视觉算法测量螺丝尺寸时，不会因为传送带的轻微震动（物距变化）而得出错误数据。</li>
</ul>
<hr>
<h2 id="5-焦深与景深的计算-Code"><a href="#5-焦深与景深的计算-Code" class="headerlink" title="5. 焦深与景深的计算 Code"></a>5. 焦深与景深的计算 Code</h2><p>为了彻底打破抽象公式的壁垒，我们编写了一套 Python 代码，不仅可以量化分析参数的影响，还能“画”出几何光学的核心原理图。</p>
<p>这段代码将生成两张关键图像：</p>
<ol>
<li><strong>参数敏感度面板</strong>：一目了然地看到光圈、焦距如何非线性地改变景深。</li>
<li><strong>光路原理示意图</strong>：直观展示光线如何汇聚，以及“允许弥散圆”是如何定义焦深边界的。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> matplotlib.patches <span class="hljs-keyword">as</span> patches<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OpticalVisualizer</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, f=<span class="hljs-number">50</span>, N=<span class="hljs-number">2.8</span>, c=<span class="hljs-number">0.029</span></span>):<br>        <span class="hljs-variable language_">self</span>.f = f  <span class="hljs-comment"># 焦距 (mm)</span><br>        <span class="hljs-variable language_">self</span>.N = N  <span class="hljs-comment"># 光圈数</span><br>        <span class="hljs-variable language_">self</span>.c = c  <span class="hljs-comment"># 弥散圆 (mm)</span><br>        <span class="hljs-variable language_">self</span>.D = f / N  <span class="hljs-comment"># 入瞳直径 (mm)</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">plot_sensitivity_analysis</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        绘制参数敏感度分析图：</span><br><span class="hljs-string">        1. 景深 vs 拍摄距离 (不同光圈)</span><br><span class="hljs-string">        2. 焦深 vs 光圈值</span><br><span class="hljs-string">        3. 超焦距 vs 焦距</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        fig, axes = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, figsize=(<span class="hljs-number">18</span>, <span class="hljs-number">5</span>))<br><br>        <span class="hljs-comment"># --- 子图 1: 景深 vs 拍摄距离 ---</span><br>        u_arr = np.linspace(<span class="hljs-number">500</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">100</span>)  <span class="hljs-comment"># 0.5m 到 5m</span><br>        f_stops = [<span class="hljs-number">1.4</span>, <span class="hljs-number">4.0</span>, <span class="hljs-number">11.0</span>]<br>        colors = [<span class="hljs-string">&#x27;#FF5733&#x27;</span>, <span class="hljs-string">&#x27;#33FF57&#x27;</span>, <span class="hljs-string">&#x27;#3357FF&#x27;</span>]<br><br>        ax1 = axes[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">for</span> i, N_val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(f_stops):<br>            <span class="hljs-comment"># 近似公式计算 total DoF (为了平滑显示)</span><br>            H = (<span class="hljs-variable language_">self</span>.f ** <span class="hljs-number">2</span>) / (N_val * <span class="hljs-variable language_">self</span>.c)<br>            <span class="hljs-comment"># DoF ≈ 2 u^2 N c / f^2</span><br>            dof = (<span class="hljs-number">2</span> * u_arr ** <span class="hljs-number">2</span> * N_val * <span class="hljs-variable language_">self</span>.c) / (<span class="hljs-variable language_">self</span>.f ** <span class="hljs-number">2</span>)<br>            ax1.plot(u_arr / <span class="hljs-number">1000</span>, dof / <span class="hljs-number">1000</span>, color=colors[i], label=<span class="hljs-string">f&#x27;F/<span class="hljs-subst">&#123;N_val&#125;</span>&#x27;</span>, linewidth=<span class="hljs-number">2</span>)<br><br>        ax1.set_title(<span class="hljs-string">f&#x27;DoF vs. Subject Distance (f=<span class="hljs-subst">&#123;self.f&#125;</span>mm)&#x27;</span>)<br>        ax1.set_xlabel(<span class="hljs-string">&#x27;Subject Distance [m]&#x27;</span>)<br>        ax1.set_ylabel(<span class="hljs-string">&#x27;Total Depth of Field [m]&#x27;</span>)<br>        ax1.legend()<br>        ax1.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)<br><br>        <span class="hljs-comment"># --- 子图 2: 焦深 vs 光圈 ---</span><br>        N_arr = np.linspace(<span class="hljs-number">1.0</span>, <span class="hljs-number">22.0</span>, <span class="hljs-number">50</span>)<br>        <span class="hljs-comment"># 焦深 t = 2Nc (忽略放大率)</span><br>        dofocus = <span class="hljs-number">2</span> * N_arr * <span class="hljs-variable language_">self</span>.c<br><br>        ax2 = axes[<span class="hljs-number">1</span>]<br>        ax2.plot(N_arr, dofocus, color=<span class="hljs-string">&#x27;purple&#x27;</span>, linewidth=<span class="hljs-number">2.5</span>)<br>        ax2.fill_between(N_arr, <span class="hljs-number">0</span>, dofocus, color=<span class="hljs-string">&#x27;purple&#x27;</span>, alpha=<span class="hljs-number">0.1</span>)<br>        ax2.set_title(<span class="hljs-string">f&#x27;Depth of Focus vs. Aperture (CoC=<span class="hljs-subst">&#123;self.c&#125;</span>mm)&#x27;</span>)<br>        ax2.set_xlabel(<span class="hljs-string">&#x27;Aperture (F-Number)&#x27;</span>)<br>        ax2.set_ylabel(<span class="hljs-string">&#x27;Depth of Focus [mm]&#x27;</span>)<br>        ax2.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)<br><br>        <span class="hljs-comment"># --- 子图 3: 超焦距 vs 焦距 ---</span><br>        f_arr = np.linspace(<span class="hljs-number">14</span>, <span class="hljs-number">200</span>, <span class="hljs-number">100</span>)  <span class="hljs-comment"># 14mm 到 200mm</span><br>        <span class="hljs-comment"># H = f^2 / (Nc)</span><br>        H_arr = (f_arr ** <span class="hljs-number">2</span>) / (<span class="hljs-variable language_">self</span>.N * <span class="hljs-variable language_">self</span>.c) / <span class="hljs-number">1000</span>  <span class="hljs-comment"># 换算为米</span><br><br>        ax3 = axes[<span class="hljs-number">2</span>]<br>        ax3.plot(f_arr, H_arr, color=<span class="hljs-string">&#x27;teal&#x27;</span>, linewidth=<span class="hljs-number">2.5</span>)<br>        ax3.set_title(<span class="hljs-string">f&#x27;Hyperfocal Dist vs. Focal Length (F/<span class="hljs-subst">&#123;self.N&#125;</span>)&#x27;</span>)<br>        ax3.set_xlabel(<span class="hljs-string">&#x27;Focal Length [mm]&#x27;</span>)<br>        ax3.set_ylabel(<span class="hljs-string">&#x27;Hyperfocal Distance [m]&#x27;</span>)<br>        ax3.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)<br><br>        plt.tight_layout()<br>        plt.show()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_ray_diagram</span>(<span class="hljs-params">self, u_dist_mm=<span class="hljs-number">1000</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        绘制示意性光路图 (Schematic Ray Diagram)</span><br><span class="hljs-string">        注意：为了可视化，这里的横纵坐标比例是非等比的，且大大夸张了光圈和传感器尺寸。</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        fig, ax = plt.subplots(figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))<br><br>        <span class="hljs-comment"># 1. 基础光学计算</span><br>        v_dist = <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> / <span class="hljs-variable language_">self</span>.f - <span class="hljs-number">1</span> / u_dist_mm)  <span class="hljs-comment"># 像距 v</span><br>        mag = v_dist / u_dist_mm  <span class="hljs-comment"># 放大率</span><br><br>        <span class="hljs-comment"># 焦深半宽 delta = N * c * (1+m)</span><br>        delta = <span class="hljs-variable language_">self</span>.N * <span class="hljs-variable language_">self</span>.c * (<span class="hljs-number">1</span> + mag)<br><br>        <span class="hljs-comment"># 为了画图好看，我们需要夸张 Y 轴 (光圈) 和 X 轴 (微小的焦深)</span><br>        <span class="hljs-comment"># 示意图坐标系：透镜中心在 (0,0)</span><br><br>        lens_radius = <span class="hljs-number">15</span>  <span class="hljs-comment"># 示意性半径</span><br>        img_plane_x = <span class="hljs-number">80</span>  <span class="hljs-comment"># 示意性像平面位置 (非真实比例)</span><br><br>        <span class="hljs-comment"># 定义关键点坐标</span><br>        lens_top = (<span class="hljs-number">0</span>, lens_radius)<br>        lens_bot = (<span class="hljs-number">0</span>, -lens_radius)<br><br>        <span class="hljs-comment"># 像点 (理想汇聚点)</span><br>        focal_point = (img_plane_x, <span class="hljs-number">0</span>)<br><br>        <span class="hljs-comment"># --- 绘图 ---</span><br><br>        <span class="hljs-comment"># A. 画透镜</span><br>        lens = patches.Ellipse((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), width=<span class="hljs-number">5</span>, height=lens_radius * <span class="hljs-number">2.2</span>, angle=<span class="hljs-number">0</span>,<br>                               color=<span class="hljs-string">&#x27;#aaddff&#x27;</span>, alpha=<span class="hljs-number">0.5</span>, label=<span class="hljs-string">&#x27;Lens&#x27;</span>)<br>        ax.add_patch(lens)<br>        ax.axvline(<span class="hljs-number">0</span>, color=<span class="hljs-string">&#x27;blue&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>, alpha=<span class="hljs-number">0.3</span>)  <span class="hljs-comment"># 透镜平面</span><br><br>        <span class="hljs-comment"># B. 画光轴</span><br>        ax.axhline(<span class="hljs-number">0</span>, color=<span class="hljs-string">&#x27;black&#x27;</span>, linestyle=<span class="hljs-string">&#x27;-&#x27;</span>, alpha=<span class="hljs-number">0.2</span>)<br><br>        <span class="hljs-comment"># C. 画光锥 (Rays) - 像方空间</span><br>        <span class="hljs-comment"># 上边缘光线</span><br>        ax.plot([<span class="hljs-number">0</span>, img_plane_x + <span class="hljs-number">20</span>], [lens_radius, -lens_radius * (<span class="hljs-number">20</span> / img_plane_x)],<br>                color=<span class="hljs-string">&#x27;orange&#x27;</span>, alpha=<span class="hljs-number">0.8</span>, linewidth=<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># 下边缘光线</span><br>        ax.plot([<span class="hljs-number">0</span>, img_plane_x + <span class="hljs-number">20</span>], [-lens_radius, lens_radius * (<span class="hljs-number">20</span> / img_plane_x)],<br>                color=<span class="hljs-string">&#x27;orange&#x27;</span>, alpha=<span class="hljs-number">0.8</span>, linewidth=<span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment"># 填充光锥</span><br>        polygon_x = [<span class="hljs-number">0</span>, img_plane_x, <span class="hljs-number">0</span>]<br>        polygon_y = [lens_radius, <span class="hljs-number">0</span>, -lens_radius]<br>        ax.fill(polygon_x, polygon_y, color=<span class="hljs-string">&#x27;orange&#x27;</span>, alpha=<span class="hljs-number">0.05</span>)<br><br>        <span class="hljs-comment"># D. 画像平面 (Sensor Plane) 和 焦深范围</span><br>        <span class="hljs-comment"># 焦深在图中被放大显示以便观察</span><br>        dof_scale = <span class="hljs-number">10</span>  <span class="hljs-comment"># 夸张系数</span><br>        dx = delta * dof_scale<br><br>        <span class="hljs-comment"># 理想焦平面</span><br>        ax.axvline(img_plane_x, color=<span class="hljs-string">&#x27;black&#x27;</span>, label=<span class="hljs-string">&#x27;Ideal Image Plane (Sharp)&#x27;</span>, linewidth=<span class="hljs-number">2</span>)<br><br>        <span class="hljs-comment"># 焦深前界 (Near Limit)</span><br>        ax.axvline(img_plane_x - dx, color=<span class="hljs-string">&#x27;red&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>, label=<span class="hljs-string">&#x27;Focus Depth Limit&#x27;</span>)<br>        <span class="hljs-comment"># 焦深后界 (Far Limit)</span><br>        ax.axvline(img_plane_x + dx, color=<span class="hljs-string">&#x27;red&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>)<br><br>        <span class="hljs-comment"># E. 画弥散圆 (CoC) 示意</span><br>        <span class="hljs-comment"># 在焦深界限处，光线的高度应该刚好是 CoC 的一半 (示意)</span><br>        coc_h = <span class="hljs-number">3</span>  <span class="hljs-comment"># 示意高度</span><br><br>        <span class="hljs-comment"># 绘制 Near Limit 处的 CoC</span><br>        rect_near = patches.Rectangle((img_plane_x - dx - <span class="hljs-number">0.5</span>, -coc_h), <span class="hljs-number">1</span>, coc_h * <span class="hljs-number">2</span>,<br>                                      color=<span class="hljs-string">&#x27;red&#x27;</span>, alpha=<span class="hljs-number">0.3</span>)<br>        ax.add_patch(rect_near)<br><br>        <span class="hljs-comment"># 绘制 Far Limit 处的 CoC</span><br>        rect_far = patches.Rectangle((img_plane_x + dx - <span class="hljs-number">0.5</span>, -coc_h), <span class="hljs-number">1</span>, coc_h * <span class="hljs-number">2</span>,<br>                                     color=<span class="hljs-string">&#x27;red&#x27;</span>, alpha=<span class="hljs-number">0.3</span>)<br>        ax.add_patch(rect_far)<br><br>        <span class="hljs-comment"># 标注</span><br>        ax.annotate(<span class="hljs-string">r&#x27;Focus Depth ($\delta$)&#x27;</span>,<br>                    xy=(img_plane_x, -lens_radius / <span class="hljs-number">2</span>), xytext=(img_plane_x - <span class="hljs-number">15</span>, -lens_radius),<br>                    arrowprops=<span class="hljs-built_in">dict</span>(arrowstyle=<span class="hljs-string">&#x27;&lt;-&gt;&#x27;</span>, color=<span class="hljs-string">&#x27;purple&#x27;</span>), color=<span class="hljs-string">&#x27;purple&#x27;</span>, fontsize=<span class="hljs-number">12</span>)<br><br>        ax.annotate(<span class="hljs-string">&#x27;Circle of Confusion (CoC)&#x27;</span>,<br>                    xy=(img_plane_x - dx, coc_h), xytext=(img_plane_x - <span class="hljs-number">30</span>, coc_h + <span class="hljs-number">5</span>),<br>                    arrowprops=<span class="hljs-built_in">dict</span>(facecolor=<span class="hljs-string">&#x27;black&#x27;</span>, arrowstyle=<span class="hljs-string">&#x27;-&gt;&#x27;</span>), fontsize=<span class="hljs-number">10</span>)<br><br>        <span class="hljs-comment"># 图表设置</span><br>        ax.set_xlim(-<span class="hljs-number">10</span>, <span class="hljs-number">110</span>)<br>        ax.set_ylim(-<span class="hljs-number">20</span>, <span class="hljs-number">20</span>)<br>        ax.set_title(<br>            <span class="hljs-string">f&#x27;Schematic Optical Path: Depth of Focus Formation\n(Not to Scale: Axial distances compressed, CoC magnified)&#x27;</span>,<br>            fontsize=<span class="hljs-number">14</span>)<br>        ax.set_xlabel(<span class="hljs-string">&#x27;Optical Axis (Arbitrary Units)&#x27;</span>)<br>        ax.set_ylabel(<span class="hljs-string">&#x27;Radial Height&#x27;</span>)<br>        ax.legend(loc=<span class="hljs-string">&#x27;upper right&#x27;</span>)<br>        ax.set_yticks([])  <span class="hljs-comment"># 隐藏Y轴刻度，因为是示意图</span><br><br>        plt.tight_layout()<br>        plt.show()<br><br><br><span class="hljs-comment"># --- 执行可视化 ---</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># 初始化：50mm F1.8 镜头</span><br>    viz = OpticalVisualizer(f=<span class="hljs-number">50</span>, N=<span class="hljs-number">1.8</span>, c=<span class="hljs-number">0.029</span>)<br><br>    <span class="hljs-comment"># 1. 绘制参数关系图</span><br>    viz.plot_sensitivity_analysis()<br><br>    <span class="hljs-comment"># 2. 绘制光路原理图</span><br>    viz.draw_ray_diagram()<br></code></pre></td></tr></table></figure>

<h4 id="图表一：参数敏感度分析"><a href="#图表一：参数敏感度分析" class="headerlink" title="图表一：参数敏感度分析"></a>图表一：参数敏感度分析</h4><p><img src="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_112134.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li><strong>左图 (DoF vs Distance)</strong>：这是最经典的“抛物线”增长。你会发现，F11 的增长速度远快于 F1.4。这解释了为什么“退后两步”是获得大景深最廉价的方法。</li>
<li><strong>中图 (DoFocus vs Aperture)</strong>：展示了极其完美的<strong>线性关系</strong>。光圈数值翻倍（光孔变小），焦深严格翻倍。这对于工业检测极其重要：如果你的零件在传送带上抖动幅度为 0.1mm，你只需要查表就能算出需要缩到多少光圈才能保证清晰。</li>
<li><strong>右图 (Hyperfocal vs Focal Length)</strong>：展示了<strong>指数级</strong>的增长。焦距增加一倍，超焦距会增加四倍（$H \propto f^2$）。这就是为什么长焦镜头极难获得全景深，而广角镜头随手一拍都是清楚的。</li>
</ol>
<h4 id="图表二：几何光路原理-Schematic"><a href="#图表二：几何光路原理-Schematic" class="headerlink" title="图表二：几何光路原理 (Schematic)"></a>图表二：几何光路原理 (Schematic)</h4><p><img src="https://suncos-01-1254144885.cos.ap-shanghai.myqcloud.com/Hexo/clipboard_20260128_112042.png" srcset="/img/loading.gif" lazyload><br>这张图是理解“模糊”本质的关键：</p>
<ul>
<li><strong>橙色锥体</strong>：代表光束。光圈越大，锥体底座（透镜处）越宽，锥角越大。</li>
<li><strong>黑色实线 (Ideal Image Plane)</strong>：这是光线汇聚成完美一点的位置。</li>
<li><strong>红色虚线 (Limits)</strong>：这是光斑扩散到<strong>允许弥散圆 (CoC)</strong> 大小的位置。</li>
<li><strong>焦深 ($\delta$)</strong>：两根红色虚线之间的距离。</li>
</ul>
<p><strong>直观结论</strong>：如果光圈变小（透镜变窄），橙色光锥会变得更“细长”。这意味着光线在汇聚点前后的扩散速度变慢了，红色虚线就可以推得更远——这就是<strong>缩光圈增加焦深&#x2F;景深</strong>的几何本质。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>从光的衍射到数学的近似，焦深与景深不仅仅是摄影师手中的工具，更是连接物理光学与现实世界的桥梁。理解它们，实际上是在理解光学系统传递信息的容量与限制。无论是捕捉瞬间的艺术，还是制造纳米芯片的工艺，我们都在这“清晰与模糊”的边缘上起舞。</p>
<p>希望通过本文的原理推导，能让你在下一次按下快门，或设计光路时，拥有更深刻的直觉。</p>
<hr>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Computational-Photography/" class="category-chain-item">Computational Photography</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Optics/" class="print-no-link">#Optics</a>
      
        <a href="/tags/Physics/" class="print-no-link">#Physics</a>
      
        <a href="/tags/Algorithm/" class="print-no-link">#Algorithm</a>
      
        <a href="/tags/Photography/" class="print-no-link">#Photography</a>
      
        <a href="/tags/Engineering/" class="print-no-link">#Engineering</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>透视光影的边界：从第一性原理深度解析焦深与景深</div>
      <div>https://sunfove.xyz/2026/01/28/2026-01-28-depth-of-field-vs-depth-of-focus-analysis/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Sunfove</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>January 28, 2026</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2026/01/28/2026-01-28-daily-english/" title="🌍 Daily English: Beyond Conventional Optics: How Metasurfaces Are Redefining Light Manipulation | 2026-01-28">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">🌍 Daily English: Beyond Conventional Optics: How Metasurfaces Are Redefining Light Manipulation | 2026-01-28</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2026/01/27/2026-01-27-daily-english/" title="🌍 Daily English: The Architecture of Thought: How Cognitive Psychology Illuminates Mental Health | 2026-01-27">
                        <span class="hidden-mobile">🌍 Daily English: The Architecture of Thought: How Cognitive Psychology Illuminates Mental Health | 2026-01-27</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="SOHUCS" sid='https://sunfove.xyz/2026/01/28/2026-01-28-depth-of-field-vs-depth-of-focus-analysis/'></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#SOHUCS', function() {
      Fluid.utils.createScript("https://changyan.sohu.com/upload/changyan.js", function() {
        window.changyan.api.config({"appid":"cyuxpCk8o","appkey":"f8c285c3ec3462cdf39ccaa25e563036"})
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      浙ICP备19044173号
    </a>
  </span>
  
</div>

  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<!-- hexo injector body_end start --><script src="https://fastly.jsdelivr.net/npm/hexo-tag-common@0.2.0/js/index.js"></script><!-- hexo injector body_end end --></body>
</html>
